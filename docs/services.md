---
id: services
title: سرویس‌ها
sidebar_label: سرویس‌ها
---

هر سرویس در فندق یک نسخه در حال اجرا از یک ورژن بخصوص از یکی از image های شماست. سرویس‌های در حال اجرای شما همواره از طریق fandogh service list قابل مشاهده است و می‌توانید هر زمان مایل بودید از طریق دستور fandogh service destroy آنها را حذف کنید.
## ساخت سرویس‌ها
برای ساخت سرویس‌ها شما نیاز دارید از دستور fandogh service deploy استفاده کنید، با انتخاب یک ایمیج بخصوص و یک ورژن بخصوص از‌ آن تصویر و انتخاب یک نام برای سرویس، سرویس شما ساخته خواهد شد.\
نامی که برای سرویس انتخاب می‌کنید همان نامی است که بعدا به شما کمک می‌کند در شبکه خصوصی فضانام آن سرویس را پیدا کنید، به علاوه برای سرویس‌هایی که  internal-- نیستند یک hostname به شکل زیر نیز در نظر گرفته می‌شود که می‌توانید از طریق آن به سرویس خود دسترسی پیدا کنید.\
  `ServiceName-Namespace.fandogh.cloud`\
فقط لطفا توجه کنید که چون نام service قرار است به عنوان بخشی از Hostname استفاده شود  این محدودیت‌ها را لازم است رعایت کنید:
-   فقط می‌تواند شامل حروف کوچک، اعداد و خط تیره باشد.
-   نمی‌تواند با اعداد آغاز شود.
-   نمی‌تواند با خط تیره آغاز یا پایان یابد.
-   نمی‌تواند حاوی دو خط تیره متوالی باشد.

### پارامتر‌های ساخت سرویس
ساخت سرویس پارامتر‌های زیادی دارد که می‌توانید هنگام ساخت استفاده کنید:

* **--registry-secret** یا **-s**
در صورتی که Image  مورد نظر شما در یک رجیستری private باشد که برای pull کردن نیاز به Username/password باشد از طریق این پارامتر می‌توانید [Secret](/docs/secret.html)ای که حاوی اطلاعات لازم است را مشخص کنید.

* **--env** یا **-e**
از طریق این پارامتر مشخص می‌کنید می‌توانید environment variable های مختلف مورد نیاز سرویس برای اجرا را مشخص کنید.توجه داشته باشید که هیچ محدودیتی در تعداد `--env` وجود ندارد .به عنوان مثال فرض کنید سرویس برای کار به پارامتر‌های api_token و secret_key نیاز دارد، در این صورت از این طریق پارامتر‌ها را مشخص می‌کنید:
```
fandogh service deploy
	--env api_token="some token"
	--env api_secret_key="some secret key"
```
* **--port** یا **-p**
از طریق این پارامتر مشخص می‌کنید می‌توانید کدام یک از پورت‌های سرویس مورد نظر خود را می‌خواهید در دسترس قرار دهید.در صورت عدم مشخص کردن پورت بخصوصی، پورت 80 در دسترس قرار می‌گیرد.
مثلا فرض کنید می‌خواهیم به جای 80 از پورت 8080 استفاده کنیم:
```
fandogh service deploy --port 8080
```
* **--internal**
در حالت عادی پورت مورد نظر هر سرویس به صورت public قابل دسترس است، با اضافه کردن سویچ `--internal‍` می‌توانید پورت مورد نظر را فقط در شبکه داخلی خودتان قابل دسترس نگهدارید.
```
fandogh service deploy --internal
```
* **--hosts** یا **-h**
از طریق این سویچ می‌توانید از بین دامنه‌هایی که قبلا ثبت و تایید کرده‌اید یک یا چند موررد را انتخاب کنید که به این سرویس متصل شوند، می‌توانید بیش از یکبار این سویچ را استفاده کنید مثلا:
```
fandogh service deploy
	-h site.com
	-h www.site.com
```
**دقت داشته باشید باید از طریق CNAME دامنه مورد نظر به آدرس‌های این سرویس متصل شده باشد.**

## انواع حالات مشخص کردن تصویر
برای سهولت کار کاربران، ما در فندق سه روش متفاوت برای فراهم آوردن Image مورد نظر جهت ساخت سرویس در نظر گرفته‌ایم، که هر کدام را بررسی می‌کنیم:
### ساخت سرویس از Imageهای فندق
در این حالت شما مستقیما با Image‌های داکر سروکار ندارید، فقط برای پروژه خود فایل داکر می‌نویسید و [پروژه خود را در فندق پابلیش می‌کنید.](/docs/images.html#%D8%B3%D8%A7%D8%AE%D8%AA-%D8%A7%DB%8C%D9%85%DB%8C%D8%AC-%D9%87%D8%A7)
در این روش در صورتی که در دایرکتوری پروژه خود باشید نیازی به مشخص کردن نام image ندارید، یا می‌توانید از طریق سویچ `image--` هنگام دیپلوی نام تصویر خود را مشخص کنید. \
مثلا فرض کنید که یک تصویر در فندق منتشر کرده‌اید به نام order-handling-api و می‌خواهید از روی ورژن v.3.2 آن که قبلا آن را ایجاد کرده‌اید یک سرویس با نام oh-api دیپلوی کنید، برای این کار کافیست این دستور را اجرا کنید:
```
fandogh service deploy \
	 --version v3.2 \
	 --image order-handling-api \
	 --name oh-api

```
به این ترتیب سرویس شما ساخته خواهد شد.
### ساخت سرویس از Imageهای Docker hub

در این حالت شما قصد دارید مستقیما یکی از Imageهای داخل Docker hub را در Namespace خود دیپلوی کنید، برای اینکار کافیست نام image را با فرمت namespace/image-name مشخص کنید و ورژن Image را نیز از طریق سویچ `version--‍` تغیین کنید.

> توجه داشته باشید که Imageهای رسمی داکر مثل Nginx یا Wordpress در
> Namespaceای به نام library قرار دارند.

به عنوان مثال اگر قصد ساخت سرویس از ایمیجی به نام some-ns/foo و ورژن latest داشته باشیم، باید به این ترتیب عمل کنیم:
```
fandogh service deploy \
 --image some-ns/foo \
 --version latest
 ```

### ساخت سرویس از رجیستری‌های دیگر
در صورتی که شما قصد دارید از روی Imageای سرویس دیپلوی کنید که این Image در یک رجیستری بخصوص، مثلا Canister قرار دارد، کافیست به عنوان نام Image از آدرس کامل Image به همراه URL رجیستری استفاده کنید، به عنوان مثال :
```
fandogh service deploy \
     --image cloud.canister.io:5000/mahdixareie/hello-world \
     --version v2.0 \
     --name hello-world \
     -s canister
```
همون طور که مشاهده می‌کنید علاوه بر پارامتر‌های معمول deploy پارامتر `s-` هم استفاده شده است، به دلیل اینکه رجیستری مشخص شده یک رجیستری private است، این پارامتر نام یک [Secret](/docs/secret.html) را مشخص کرده که فندق باید از آن، هنگام Pull کردن تصویر از registry، استفاده کند.
## مشاهده وضعیت سرویس
در صورتی که نیاز داشته باشید جزئیات مربوط به یک سرویس و وضعیت آن را مشاهده کنید می‌توانید از دستور details در CLI استفاده کنید، به عنوان مثال اگر نام سرویس ما blog باشد می‌توانیم به این صورت جزئیات سرویس را مشاهده کنیم:
```
$ fandogh service details --name blog
Pods:
  Name: blog-7c4864b649-2gsjj
  Phase: Running
  Containers:
    Name: blog
    Image: registry.fandogh.cloud/default/blog:3579eec2f8d2a5d51817425be1f141a2070d5e54
    Staus: Ready
    ---------------------


```

